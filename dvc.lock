schema: '2.0'
stages:
  prepare_annotations:
    cmd: pipenv run python ./src/ner/convert_bliou_to_bio.py ./data/annotation/annotation-result-orig.txt
      ./data/annotation/annotation-result.txt --out data/annotation/annotation-result-BIO.txt
    deps:
    - path: ./src/ner/convert_bliou_to_bio.py
      md5: 58229dba68e2cd8d80fa8ec7f45476c9
      size: 1940
    - path: data/annotation/annotation-result-orig.txt
      md5: f368553363edd3d250db16bfe443e176
      size: 663696
    - path: data/annotation/annotation-result.txt
      md5: a38ba160a65904f4a2f45910221aab64
      size: 1048470
    outs:
    - path: data/annotation/annotation-result-BIO.txt
      md5: 7f18755701f4ec76d05641cba2a305be
      size: 1376730
  prepare_language_model_train_set:
    cmd: pipenv run python ./src/ner/flair/prepare_lm_train_files.py ./data/jobs/seek_vacancies.db
    deps:
    - path: ./src/ner/flair/prepare_lm_train_files.py
      md5: 56d1e1751fd8524bf570602a76ab6ff7
      size: 1899
    - path: data/jobs/seek_vacancies.db
      md5: d01f95fd560d5092854627cacb9a7053
      size: 541581312
    params:
      params.yaml:
        flair.language_model_train.corpus_dir: data/corpus/jobs
    outs:
    - path: data/corpus/jobs/train
      md5: 14cd263f9b3a59dfff45f5cf07eb17d9.dir
      size: 373151466
      nfiles: 100
  finetune_backward_lm:
    cmd: pipenv run python src/ner/flair/train_language_model.py --out=models/jobs_lm_backward
      --backward
    deps:
    - path: data/corpus/jobs/test.txt
      md5: e6d040005443dc7b485df62ba359f01b
      size: 3791917
    - path: data/corpus/jobs/train
      md5: 14cd263f9b3a59dfff45f5cf07eb17d9.dir
      size: 373151466
      nfiles: 100
    - path: data/corpus/jobs/valid.txt
      md5: 3038a3bec712939157ca4c6186b46df5
      size: 3872807
    - path: src/ner/flair/train_language_model.py
      md5: fae51be9ae8712144ae6ce4afcc333fe
      size: 2856
    params:
      params.yaml:
        flair.language_model_train.num_epochs: 1
    outs:
    - path: models/jobs_lm_backward/best-lm.pt
      md5: e75f9445cc3d863ef16eb1e8622b86fa
      size: 73037151
    - path: models/jobs_lm_backward/checkpoint.pt
      md5: ab0d64e1da7ee9a4366387edab357880
      size: 73037471
  prepare_annotations_val:
    cmd: pipenv run python ./src/ner/convert_bliou_to_bio.py ./data/annotation/annotation-result-val.txt
      --out data/annotation/annotation-result-BIO-val.txt
    deps:
    - path: ./src/ner/convert_bliou_to_bio.py
      md5: 58229dba68e2cd8d80fa8ec7f45476c9
      size: 1940
    - path: data/annotation/annotation-result-val.txt
      md5: 6c4b909e153e8d976d73983de79fe728
      size: 161741
    outs:
    - path: data/annotation/annotation-result-BIO-val.txt
      md5: 8b2b7ece5ca1ac9d1dbbc5b1b244a526
      size: 129848
